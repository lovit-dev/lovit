import React, { useEffect, useState, type ReactElement } from 'react';

interface PackageManager {
  id: string;
  label: string;
  icon: ReactElement;
  commandTemplate: string;
}

interface PackageManagerTabsProps extends React.ComponentPropsWithoutRef<'pre'> {
  packageName?: string;
  customPackageManagers?: PackageManager[];
}

const defaultPackageManagers: PackageManager[] = [
  {
    id: 'npm',
    label: 'npm',
    icon: (
      <svg
        viewBox='0 0 256 256'
        version='1.1'
        xmlns='http://www.w3.org/2000/svg'
        xmlns:xlink='http://www.w3.org/1999/xlink'
        preserveAspectRatio='xMidYMid'
        fill='#000000'
      >
        <g id='SVGRepo_bgCarrier' stroke-width='0'></g>
        <g id='SVGRepo_tracerCarrier' stroke-linecap='round' stroke-linejoin='round'></g>
        <g id='SVGRepo_iconCarrier'>
          {' '}
          <g>
            {' '}
            <polygon fill='#C12127' points='0 256 0 0 256 0 256 256'>
              {' '}
            </polygon>{' '}
            <polygon fill='#FFFFFF' points='48 48 208 48 208 208 176 208 176 80 128 80 128 208 48 208'>
              {' '}
            </polygon>{' '}
          </g>{' '}
        </g>
      </svg>
    ),
    commandTemplate: 'npm install {package}'
  },
  {
    id: 'yarn',
    label: 'yarn',
    icon: (
      <svg
        viewBox='0 0 256 256'
        version='1.1'
        xmlns='http://www.w3.org/2000/svg'
        xmlns:xlink='http://www.w3.org/1999/xlink'
        preserveAspectRatio='xMidYMid'
        fill='#000000'
      >
        <g id='SVGRepo_bgCarrier' stroke-width='0'></g>
        <g id='SVGRepo_tracerCarrier' stroke-linecap='round' stroke-linejoin='round'></g>
        <g id='SVGRepo_iconCarrier'>
          {' '}
          <g>
            {' '}
            <path
              d='M128,0 C57.3281853,0 0,57.3281853 0,128 C0,198.671815 57.3281853,256 128,256 C198.671815,256 256,198.671815 256,128 C256,57.3281853 198.671815,0 128,0'
              fill='#368FB9'
            >
              {' '}
            </path>{' '}
            <path
              d='M203.317375,174.060232 C195.410039,175.938224 191.40695,177.667954 181.621622,184.043243 C166.350579,193.927413 149.646332,198.523552 149.646332,198.523552 C149.646332,198.523552 148.262548,200.599228 144.259459,201.538224 C137.340541,203.218533 111.295753,204.651737 108.923552,204.701158 C102.548263,204.750579 98.6440154,203.07027 97.5567568,200.450965 C94.2455598,192.543629 102.301158,189.08417 102.301158,189.08417 C102.301158,189.08417 100.522008,187.996911 99.4841699,187.008494 C98.5451737,186.069498 97.5567568,184.191506 97.2602317,184.883398 C96.0247104,187.898069 95.3822394,195.261776 92.0710425,198.572973 C87.5243243,203.169112 78.9250965,201.637066 73.834749,198.96834 C68.2501931,196.003089 74.2301158,189.034749 74.2301158,189.034749 C74.2301158,189.034749 71.215444,190.8139 68.7938224,187.156757 C66.619305,183.796139 64.5930502,178.06332 65.1366795,170.996139 C65.7297297,162.940541 74.7243243,155.132046 74.7243243,155.132046 C74.7243243,155.132046 73.1428571,143.221622 78.3320463,131.014672 C83.027027,119.894981 95.6787645,110.949807 95.6787645,110.949807 C95.6787645,110.949807 85.0532819,99.1876448 89.0069498,88.611583 C91.576834,81.6926641 92.6146718,81.7420849 93.4548263,81.4455598 C96.4200772,80.3088803 99.2864865,79.0733591 101.411583,76.7505792 C112.037066,65.2849421 125.578378,67.4594595 125.578378,67.4594595 C125.578378,67.4594595 132.003089,47.9382239 137.933591,51.7436293 C139.762162,52.9297297 146.335135,67.5583012 146.335135,67.5583012 C146.335135,67.5583012 153.352896,63.4563707 154.143629,64.988417 C158.393822,73.2416988 158.888031,89.0069498 157.010039,98.5945946 C153.847104,114.409266 145.939768,122.909653 142.776834,128.247104 C142.035521,129.482625 151.27722,133.386873 157.10888,149.54749 C162.495753,164.324324 157.701931,176.728958 158.542085,178.112741 C158.690347,178.359846 158.739768,178.458687 158.739768,178.458687 C158.739768,178.458687 164.917375,178.952896 177.322008,171.292664 C183.944402,167.190734 191.802317,162.594595 200.74749,162.495753 C209.396139,162.34749 209.840927,172.478764 203.317375,174.060232 L203.317375,174.060232 Z M215.079537,166.795367 C214.189961,159.777606 208.259459,154.934363 200.648649,155.033205 C189.281853,155.181467 179.743629,161.062548 173.417761,164.966795 C170.946718,166.498842 168.821622,167.635521 166.99305,168.475676 C167.388417,162.742857 167.042471,155.230888 164.07722,146.977606 C160.469498,137.093436 155.626255,131.014672 152.166795,127.505792 C156.169884,121.674131 161.655598,113.173745 164.225483,100.027799 C166.449421,88.8092664 165.757529,71.3637066 160.667181,61.5783784 C159.629344,59.6015444 157.899614,58.1683398 155.725097,57.5752896 C154.835521,57.3281853 153.155212,56.8339768 149.844015,57.772973 C144.85251,47.4440154 143.12278,46.3567568 141.788417,45.4671815 C139.020849,43.6880309 135.759073,43.2926641 132.694981,44.4293436 C128.59305,45.9119691 125.08417,49.8656371 121.772973,56.8833977 C121.278764,57.9212355 120.833977,58.9096525 120.43861,59.8980695 C114.162162,60.3428571 104.277992,62.6162162 95.9258687,71.6602317 C94.8880309,72.7969112 92.8617761,73.6370656 90.7366795,74.4277992 L90.7861004,74.4277992 C86.4370656,75.9598456 84.4602317,79.5181467 82.03861,85.9428571 C78.6779923,94.9374517 82.1374517,103.783784 85.5474903,109.516602 C80.9019305,113.667954 74.7243243,120.290347 71.4625483,128.049421 C67.4100386,137.637066 66.965251,147.027027 67.1135135,152.117375 C63.6540541,155.774517 58.3166023,162.644015 57.7235521,170.353668 C56.9328185,181.127413 60.8370656,188.441699 62.5667954,191.110425 C63.0610039,191.901158 63.6046332,192.543629 64.1976834,193.1861 C64,194.520463 63.9505792,195.953668 64.2471042,197.436293 C64.8895753,200.895753 67.0640927,203.712741 70.3752896,205.491892 C76.8988417,208.951351 85.992278,210.433977 93.0100386,206.925097 C95.5305019,209.593822 100.126641,212.163707 108.478764,212.163707 L108.972973,212.163707 C111.098069,212.163707 138.081853,210.730502 145.939768,208.803089 C149.448649,207.962934 151.87027,206.480309 153.451737,205.145946 C158.492664,203.564479 172.429344,198.820077 185.57529,190.319691 C194.866409,184.290347 198.078764,183.005405 204.997683,181.325097 C211.718919,179.694208 215.919691,173.566023 215.079537,166.795367 L215.079537,166.795367 Z'
              fill='#FFFFFF'
            >
              {' '}
            </path>{' '}
          </g>{' '}
        </g>
      </svg>
    ),
    commandTemplate: 'yarn add {package}'
  },
  {
    id: 'pnpm',
    label: 'pnpm',
    icon: (
      <svg
        xmlns='http://www.w3.org/2000/svg'
        fill='none'
        viewBox='0 0 16 16'
        id='Pnpm--Streamline-Svg-Logos'
        height='16'
        width='16'
      >
        <desc>Pnpm Streamline Icon: https://streamlinehq.com</desc>
        <path
          fill='#f9ad00'
          d='M15.833383333333332 6.243733333333333v3.5125833333333336H12.3208V6.243733333333333h3.5125833333333336Zm0 -3.86385v3.5125833333333336H12.3208V2.379883333333333h3.5125833333333336Zm-3.86385 0v3.5125833333333336H8.456949999999999V2.379883333333333h3.5125833333333336Zm-3.86385 0v3.5125833333333336H4.5931V2.379883333333333h3.5125833333333336Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#4e4e4e'
          d='M11.969483333333333 10.107583333333332V13.620166666666666H8.4569V10.107583333333332h3.5125833333333336Zm3.86385 0V13.620166666666666H12.320749999999999V10.107583333333332H15.833333333333332Zm-7.7277 0V13.620166666666666H4.59305V10.107583333333332h3.5125833333333336Zm3.86385 -3.86385v3.5125833333333336H8.4569V6.243733333333333h3.5125833333333336ZM0.824645 7.2687c0.11802333333333333 0 0.22768666666666665 0.01525 0.3289883333333333 0.04573333333333333 0.10130333333333333 0.0305 0.18834499999999998 0.07721666666666666 0.2611266666666666 0.14016666666666666 0.07278 0.06293333333333333 0.129825 0.14211666666666667 0.1711333333333333 0.23751666666666665 0.04130833333333333 0.0954 0.061961666666666665 0.209 0.061961666666666665 0.3407833333333333 0 0.12589999999999998 -0.01770333333333333 0.23604999999999998 -0.05311 0.33046666666666663 -0.03540666666666666 0.09441666666666666 -0.08556666666666665 0.1736 -0.15048 0.23753333333333332 -0.06491166666666666 0.06391666666666666 -0.14310166666666665 0.11161666666666666 -0.23456999999999997 0.1431 -0.09146833333333333 0.031466666666666664 -0.19326333333333334 0.0472 -0.305385 0.0472 -0.08458333333333332 0 -0.163265 -0.012783333333333334 -0.23604499999999998 -0.038349999999999995v0.4898l-0.00475 0.0013666666666666666c-0.01983333333333333 0.005516666666666666 -0.04972333333333333 0.011449999999999998 -0.08966833333333332 0.0178 -0.043274999999999994 0.006883333333333333 -0.08753499999999999 0.010333333333333333 -0.13277666666666665 0.010333333333333333 -0.043274999999999994 0 -0.082125 -0.00295 -0.11654833333333332 -0.00885 -0.034423333333333334 -0.0059 -0.06343666666666667 -0.0177 -0.08704166666666666 -0.035416666666666666 -0.02360333333333333 -0.0177 -0.04130833333333333 -0.041800000000000004 -0.05311 -0.07228333333333332C0.17256833333333332 9.125116666666667 0.16666666666666666 9.085283333333333 0.16666666666666666 9.0361V7.619833333333333l0.00015 -0.010499999999999999c0.001408333333333333 -0.048350000000000004 0.012668333333333332 -0.08811666666666665 0.03378166666666667 -0.11933333333333332 0.022621666666666665 -0.03343333333333333 0.053601666666666666 -0.06393333333333333 0.09294333333333334 -0.09146666666666665 0.06097833333333333 -0.039349999999999996 0.13671 -0.07081666666666667 0.2271933333333333 -0.09441666666666666 0.090485 -0.0236 0.19178833333333334 -0.035416666666666666 0.30391 -0.035416666666666666Zm3.4462716666666666 0c0.11801666666666666 0 0.22768333333333335 0.01525 0.3289833333333333 0.04573333333333333 0.10131666666666667 0.0305 0.18835000000000002 0.07721666666666666 0.26113333333333333 0.14016666666666666 0.07278333333333332 0.06293333333333333 0.12981666666666666 0.14211666666666667 0.1711333333333333 0.23751666666666665 0.041299999999999996 0.0954 0.06196666666666667 0.209 0.06196666666666667 0.3407833333333333 0 0.12589999999999998 -0.017716666666666665 0.23604999999999998 -0.05311666666666666 0.33046666666666663 -0.0354 0.09441666666666666 -0.08556666666666665 0.1736 -0.15048333333333333 0.23753333333333332 -0.06491666666666666 0.06391666666666666 -0.1431 0.11161666666666666 -0.23456666666666665 0.1431 -0.09146666666666665 0.031466666666666664 -0.19326666666666664 0.0472 -0.30538333333333334 0.0472 -0.08458333333333332 0 -0.16326666666666667 -0.012783333333333334 -0.23604999999999998 -0.038349999999999995v0.4898l-0.00475 0.0013666666666666666c-0.01983333333333333 0.005516666666666666 -0.049716666666666666 0.011449999999999998 -0.08966666666666667 0.0178 -0.04326666666666666 0.006883333333333333 -0.08753333333333332 0.010333333333333333 -0.13276666666666664 0.010333333333333333 -0.043283333333333326 0 -0.08213333333333334 -0.00295 -0.11655 -0.00885 -0.03443333333333333 -0.0059 -0.06344999999999999 -0.0177 -0.08704999999999999 -0.035416666666666666 -0.0236 -0.0177 -0.041299999999999996 -0.041800000000000004 -0.053099999999999994 -0.07228333333333332 -0.011816666666666666 -0.030483333333333335 -0.017716666666666665 -0.07031666666666667 -0.017716666666666665 -0.1195V7.619833333333333l0.00015 -0.010499999999999999c0.0014166666666666668 -0.048350000000000004 0.012666666666666666 -0.08811666666666665 0.03378333333333333 -0.11933333333333332 0.022616666666666663 -0.03343333333333333 0.053599999999999995 -0.06393333333333333 0.09294999999999999 -0.09146666666666665 0.06096666666666667 -0.039349999999999996 0.1367 -0.07081666666666667 0.22718333333333332 -0.09441666666666666 0.09048333333333333 -0.0236 0.1918 -0.035416666666666666 0.3039166666666666 -0.035416666666666666Zm-1.6611666666666667 0c0.22226666666666664 0 0.39339999999999997 0.0487 0.5134 0.14606666666666665 0.11998333333333333 0.09736666666666667 0.17998333333333333 0.23259999999999997 0.17998333333333333 0.4057v0.9235333333333333l-0.005166666666666667 0.0014666666666666667c-0.019749999999999997 0.005416666666666667 -0.04901666666666666 0.010816666666666665 -0.08778333333333332 0.016233333333333332 -0.042283333333333326 0.0059 -0.08604999999999999 0.00885 -0.13129999999999997 0.00885 -0.04326666666666666 0 -0.08211666666666667 -0.00295 -0.11655 -0.00885 -0.034416666666666665 -0.0059 -0.06343333333333333 -0.0177 -0.08703333333333332 -0.035416666666666666 -0.023616666666666664 -0.0177 -0.041800000000000004 -0.041800000000000004 -0.05458333333333333 -0.07228333333333332 -0.012799999999999999 -0.030483333333333335 -0.01918333333333333 -0.07031666666666667 -0.01918333333333333 -0.1195v-0.6963333333333332l-0.00015 -0.0095c-0.0017166666666666667 -0.05614999999999999 -0.018883333333333332 -0.09773333333333334 -0.05148333333333333 -0.12475 -0.03443333333333333 -0.028516666666666666 -0.08115 -0.042783333333333326 -0.14015 -0.042783333333333326 -0.039349999999999996 0 -0.07819999999999999 0.004916666666666666 -0.11655 0.01475 -0.03836666666666666 0.009833333333333333 -0.07131666666666667 0.024583333333333332 -0.09885 0.04426666666666666v1.02385l-0.00515 0.0014666666666666667c-0.019766666666666665 0.005416666666666667 -0.04903333333333333 0.010816666666666665 -0.0878 0.016233333333333332 -0.042283333333333326 0.0059 -0.08604999999999999 0.00885 -0.13129999999999997 0.00885 -0.04326666666666666 0 -0.08211666666666667 -0.00295 -0.11653333333333334 -0.00885 -0.03443333333333333 -0.0059 -0.06344999999999999 -0.0177 -0.08704999999999999 -0.035416666666666666 -0.0236 -0.0177 -0.041800000000000004 -0.041800000000000004 -0.05458333333333333 -0.07228333333333332 -0.012783333333333334 -0.030483333333333335 -0.01918333333333333 -0.07031666666666667 -0.01918333333333333 -0.1195v-0.8851666666666667l0.00015 -0.010499999999999999c0.0014166666666666668 -0.048333333333333325 0.012666666666666666 -0.08811666666666665 0.03378333333333333 -0.11933333333333332 0.022616666666666663 -0.03343333333333333 0.053599999999999995 -0.06391666666666666 0.09294999999999999 -0.09146666666666665 0.06686666666666666 -0.0472 0.15096666666666667 -0.08556666666666665 0.25226666666666664 -0.11506666666666666 0.1013 -0.0295 0.21391666666666667 -0.04426666666666666 0.33785 -0.04426666666666666Zm4.322583333333333 0c0.07475 0 0.14801666666666666 0.00985 0.21981666666666666 0.029516666666666667 0.0718 0.019666666666666666 0.13573333333333332 0.05065 0.19178333333333333 0.09293333333333333 0.05606666666666666 0.042300000000000004 0.10081666666666667 0.09836666666666666 0.13424999999999998 0.16818333333333335 0.033449999999999994 0.06983333333333333 0.050166666666666665 0.15491666666666665 0.050166666666666665 0.2552333333333333v0.9294333333333333l-0.00515 0.0014666666666666667c-0.019766666666666665 0.005416666666666667 -0.04901666666666666 0.010816666666666665 -0.08778333333333332 0.016233333333333332 -0.042300000000000004 0.0059 -0.08606666666666665 0.00885 -0.13131666666666666 0.00885 -0.04326666666666666 0 -0.08211666666666667 -0.00295 -0.11653333333333334 -0.00885 -0.03443333333333333 -0.0059 -0.06344999999999999 -0.0177 -0.08704999999999999 -0.035416666666666666 -0.0236 -0.0177 -0.041800000000000004 -0.041800000000000004 -0.05458333333333333 -0.07228333333333332 -0.012783333333333334 -0.030483333333333335 -0.01918333333333333 -0.07031666666666667 -0.01918333333333333 -0.1195v-0.7051833333333333l-0.00015 -0.009683333333333332c-0.00175 -0.05403333333333333 -0.018416666666666665 -0.09358333333333332 -0.049999999999999996 -0.11866666666666666 -0.033449999999999994 -0.026549999999999997 -0.07868333333333333 -0.03983333333333333 -0.13573333333333332 -0.03983333333333333 -0.027533333333333333 0 -0.05705 0.0063999999999999994 -0.08851666666666666 0.01918333333333333 -0.031466666666666664 0.012783333333333334 -0.05508333333333333 0.02606666666666667 -0.07081666666666667 0.03983333333333333 0.0019666666666666665 0.007866666666666666 0.00295 0.015233333333333331 0.00295 0.022116666666666666v1.0017333333333331l-0.0056166666666666665 0.0014666666666666667c-0.021416666666666667 0.005416666666666667 -0.0515 0.010816666666666665 -0.09026666666666666 0.016233333333333332 -0.042300000000000004 0.0059 -0.08508333333333332 0.00885 -0.12835 0.00885 -0.043283333333333326 0 -0.08213333333333334 -0.00295 -0.11655 -0.00885 -0.03443333333333333 -0.0059 -0.06344999999999999 -0.0177 -0.08704999999999999 -0.035416666666666666 -0.0236 -0.0177 -0.041800000000000004 -0.041800000000000004 -0.05458333333333333 -0.07228333333333332 -0.012783333333333334 -0.030483333333333335 -0.01918333333333333 -0.07031666666666667 -0.01918333333333333 -0.1195v-0.7051833333333333l-0.00015 -0.009183333333333333c-0.0018166666666666665 -0.05428333333333333 -0.01995 -0.09401666666666667 -0.054433333333333334 -0.11916666666666666 -0.03638333333333333 -0.026549999999999997 -0.08015 -0.03983333333333333 -0.13129999999999997 -0.03983333333333333 -0.0354 0 -0.06589999999999999 0.005416666666666667 -0.09146666666666665 0.016233333333333332 -0.025566666666666668 0.010816666666666665 -0.0472 0.02113333333333333 -0.06491666666666666 0.030983333333333335v1.03565l-0.00515 0.0014666666666666667c-0.019749999999999997 0.005416666666666667 -0.04901666666666666 0.010816666666666665 -0.08778333333333332 0.016233333333333332 -0.042300000000000004 0.0059 -0.08606666666666665 0.00885 -0.13129999999999997 0.00885 -0.043283333333333326 0 -0.08213333333333334 -0.00295 -0.11655 -0.00885 -0.03443333333333333 -0.0059 -0.06343333333333333 -0.0177 -0.08704999999999999 -0.035416666666666666 -0.0236 -0.0177 -0.041800000000000004 -0.041800000000000004 -0.05458333333333333 -0.07228333333333332 -0.012783333333333334 -0.030483333333333335 -0.01918333333333333 -0.07031666666666667 -0.01918333333333333 -0.1195v-0.8910666666666667l0.00016666666666666666 -0.010483333333333332c0.0013999999999999998 -0.048216666666666665 0.012666666666666666 -0.08701666666666666 0.03376666666666667 -0.1164 0.02263333333333333 -0.031466666666666664 0.05361666666666666 -0.06096666666666667 0.09294999999999999 -0.08851666666666666 0.06688333333333332 -0.0472 0.14998333333333333 -0.08556666666666665 0.24931666666666666 -0.11506666666666666 0.09935 -0.0295 0.20309999999999997 -0.04426666666666666 0.31129999999999997 -0.04426666666666666 0.08063333333333333 0 0.15981666666666666 0.011316666666666666 0.23751666666666665 0.03393333333333333 0.07769999999999999 0.02263333333333333 0.14506666666666665 0.056549999999999996 0.20211666666666664 0.1018 0.059 -0.03933333333333333 0.12539999999999998 -0.0718 0.19915 -0.09736666666666667 0.07376666666666666 -0.025566666666666668 0.16278333333333334 -0.03836666666666666 0.26703333333333334 -0.03836666666666666ZM0.8423483333333334 7.661133333333333c-0.03737333333333333 0 -0.07081333333333333 0.0044333333333333325 -0.10031999999999999 0.013283333333333331 -0.029504999999999997 0.00885 -0.05507666666666666 0.019166666666666665 -0.07671499999999999 0.030983333333333335v0.6491166666666666l0.011966666666666667 0.005733333333333333c0.020216666666666668 0.0093 0.041800000000000004 0.017216666666666665 0.06474833333333332 0.023766666666666665 0.02753833333333333 0.007883333333333332 0.057045 0.011816666666666666 0.08851833333333332 0.011816666666666666 0.20260499999999998 0 0.30390833333333334 -0.12098333333333333 0.30390833333333334 -0.36293333333333333 0 -0.12588333333333332 -0.025079999999999998 -0.21931666666666666 -0.07524 -0.2803 -0.050159999999999996 -0.060983333333333334 -0.12244833333333333 -0.09146666666666665 -0.21686666666666665 -0.09146666666666665Zm3.4462683333333333 0c-0.037366666666666666 0 -0.07081666666666667 0.0044333333333333325 -0.10031666666666667 0.013283333333333331 -0.0295 0.00885 -0.05508333333333333 0.019166666666666665 -0.07671666666666666 0.030983333333333335v0.6491166666666666l0.011966666666666667 0.005733333333333333c0.020216666666666668 0.0093 0.041800000000000004 0.017216666666666665 0.06475 0.023766666666666665 0.027533333333333333 0.007883333333333332 0.05705 0.011816666666666666 0.08851666666666666 0.011816666666666666 0.2026 0 0.3039166666666666 -0.12098333333333333 0.3039166666666666 -0.36293333333333333 0 -0.12588333333333332 -0.025083333333333332 -0.21931666666666666 -0.07525 -0.2803 -0.05015 -0.060983333333333334 -0.12245 -0.09146666666666665 -0.21686666666666665 -0.09146666666666665Z'
          stroke-width='0.1667'
        ></path>
      </svg>
    ),
    commandTemplate: 'pnpm add {package}'
  },
  {
    id: 'bun',
    label: 'bun',
    icon: (
      <svg
        xmlns='http://www.w3.org/2000/svg'
        fill='none'
        viewBox='0 0 16 16'
        id='Bun--Streamline-Svg-Logos'
        height='16'
        width='16'
      >
        <desc>Bun Streamline Icon: https://streamlinehq.com</desc>
        <path
          fill='#000000'
          d='M14.165483333333334 5.1472999999999995c-0.031733333333333336 -0.033716666666666666 -0.06545 -0.06743333333333333 -0.09916666666666665 -0.09914999999999999 -0.033699999999999994 -0.031733333333333336 -0.06543333333333333 -0.06743333333333333 -0.09914999999999999 -0.09916666666666665 -0.033716666666666666 -0.031733333333333336 -0.06543333333333333 -0.06741666666666667 -0.09914999999999999 -0.09914999999999999 -0.033716666666666666 -0.031733333333333336 -0.06545 -0.06743333333333333 -0.09916666666666665 -0.09916666666666665 -0.033699999999999994 -0.031716666666666664 -0.06543333333333333 -0.06741666666666667 -0.09914999999999999 -0.09914999999999999 -0.033716666666666666 -0.031733333333333336 -0.06545 -0.06741666666666667 -0.09914999999999999 -0.09914999999999999 -0.033716666666666666 -0.031733333333333336 -0.06545 -0.06743333333333333 -0.09916666666666665 -0.09916666666666665 0.9836666666666667 0.9667166666666667 1.5471833333333331 2.281833333333333 1.5686499999999999 3.66085 0 3.286033333333333 -3.3356 5.959283333333333 -7.436699999999999 5.959283333333333 -2.2964666666666664 0 -4.350983333333333 -0.8388666666666666 -5.71735 -2.1536666666666666l0.09916666666666665 0.09914999999999999 0.09914999999999999 0.09916666666666665 0.09914999999999999 0.09914999999999999 0.09916666666666665 0.09914999999999999 0.09914999999999999 0.09916666666666665 0.09914999999999999 0.09914999999999999 0.09916666666666665 0.09914999999999999c1.364383333333333 1.3703499999999997 3.4645166666666665 2.2528333333333332 5.8165 2.2528333333333332 4.101083333333333 0 7.436699999999999 -2.67325 7.436699999999999 -5.949366666666666 0 -1.4000833333333331 -0.6028666666666667 -2.7268 -1.6678 -3.769916666666666Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#fbf0df'
          d='M14.544283333333333 8.114049999999999c0 3.0163166666666665 -3.10755 5.461516666666666 -6.940916666666666 5.461516666666666 -3.833383333333333 0 -6.940931666666666 -2.4452 -6.940931666666666 -5.461516666666666 0 -1.870083333333333 1.189865 -3.5220333333333333 3.018315 -4.5017C5.5091833333333335 2.6327 6.647499999999999 1.6292316666666666 7.603366666666666 1.6292316666666666c0.9558666666666666 0 1.7729 0.819035 3.9226166666666664 1.983118333333333 1.8284333333333331 0.9796666666666667 3.0183 2.6316166666666665 3.0183 4.5017Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#f6dece'
          d='M14.544283333333333 8.114016666666666c-0.0009666666666666666 -0.3874833333333333 -0.05433333333333333 -0.7730666666666666 -0.15864999999999999 -1.14625 -0.5414 6.6038 -8.59685 6.9211 -11.763883333333332 4.945916666666666 1.4236833333333332 1.1034833333333331 3.18055 1.6895666666666664 4.9816 1.6618499999999998 3.8274333333333335 0 6.940933333333334 -2.44915 6.940933333333334 -5.461516666666666Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#fffefc'
          d='M4.9321 3.24945c0.88645 -0.5314833333333333 2.064433333333333 -1.529 3.2225666666666664 -1.5309833333333334 -0.17816666666666664 -0.057585 -0.36406666666666665 -0.08767666666666665 -0.5512999999999999 -0.08923500000000001 -0.47991666666666666 0 -0.9915666666666666 0.24788499999999997 -1.6360833333333331 0.6207183333333333 -0.22408333333333333 0.13088333333333332 -0.4561166666666666 0.27564999999999995 -0.7020166666666667 0.4263666666666666 -0.4620666666666667 0.28556666666666664 -0.9915666666666666 0.6088166666666666 -1.5865 0.9320666666666666C1.790833333333333 4.6297 0.662435 6.313366666666667 0.662435 8.114049999999999l0 0.23598333333333332C1.8641999999999999 4.104166666666666 4.047616666666666 3.7809166666666667 4.9321 3.24945Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#ccbea7'
          d='M7.0323166666666665 2.130983333333333c0.0056166666666666665 0.9475666666666666 -0.40205 1.8504999999999998 -1.1164999999999998 2.4729666666666663 -0.05553333333333333 0.04956666666666666 -0.0119 0.14476666666666665 0.0595 0.11699999999999999 0.6683 -0.2597833333333333 1.5706333333333333 -1.0371666666666666 1.1898666666666666 -2.6058166666666667 -0.015866666666666668 -0.08925 -0.13286666666666666 -0.06545 -0.13286666666666666 0.01585Zm0.45016666666666666 0c0.49105 0.8011999999999999 0.6076666666666666 1.7769166666666667 0.3192833333333333 2.6712666666666665 -0.0238 0.06941666666666665 0.061483333333333334 0.12891666666666665 0.10906666666666666 0.07139999999999999 0.4343166666666667 -0.5552833333333334 0.8130833333333333 -1.6578833333333334 -0.32126666666666664 -2.847766666666667 -0.057499999999999996 -0.05156666666666666 -0.14675 0.027766666666666665 -0.10708333333333332 0.09716666666666665v0.007933333333333334Zm0.5473333333333332 -0.033699999999999994c0.7688333333333334 0.5443 1.2642833333333332 1.3948666666666665 1.35845 2.33215 -0.004166666666666667 0.034666666666666665 0.019616666666666664 0.06651666666666667 0.054049999999999994 0.07233333333333333 0.03443333333333333 0.005833333333333334 0.06738333333333332 -0.016399999999999998 0.07485 -0.05051666666666666 0.18245 -0.6921166666666667 0.07933333333333333 -1.8720666666666665 -1.4219 -2.4848666666666666 -0.07931666666666666 -0.031716666666666664 -0.13088333333333332 0.07536666666666667 -0.06545 0.12296666666666667v0.007933333333333334Zm-3.660833333333333 2.062433333333333c0.9141499999999999 -0.2731 1.6690666666666667 -0.9220166666666666 2.0763333333333334 -1.7848 0.03568333333333333 -0.07139999999999999 0.14873333333333333 -0.04363333333333333 0.13088333333333332 0.035699999999999996 -0.3430833333333333 1.5865 -1.4913166666666666 1.9176666666666666 -2.205233333333333 1.87405 -0.07536666666666667 0.0019833333333333335 -0.07338333333333333 -0.10313333333333333 -0.0019833333333333335 -0.12495Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#000000'
          d='M7.603383333333333 14.073333333333332C3.502283333333333 14.073333333333332 0.16666666666666666 11.400083333333331 0.16666666666666666 8.114049999999999c0 -1.9831166666666666 1.2255699999999998 -3.8333666666666666 3.2781000000000002 -4.941933333333333 0.5949333333333333 -0.31729999999999997 1.1046 -0.6365833333333333 1.558733333333333 -0.9162 0.24988333333333335 -0.15468333333333334 0.48586666666666667 -0.29945 0.7139333333333333 -0.4343166666666667 0.6960666666666666 -0.41248166666666664 1.291 -0.6881366666666666 1.8859499999999998 -0.6881366666666666 0.5949333333333333 0 1.1145 0.237975 1.7649666666666666 0.6227033333333333 0.19831666666666664 0.11303333333333333 0.3966333333333333 0.23598333333333332 0.6088166666666666 0.37083333333333335 0.4938 0.30541666666666667 1.0510666666666666 0.6504666666666666 1.7848166666666665 1.0451166666666665 2.0525333333333333 1.1085666666666665 3.2781000000000002 2.956833333333333 3.2781000000000002 4.941933333333333 0 3.286033333333333 -3.3356166666666667 5.959283333333333 -7.436699999999999 5.959283333333333Zm0 -12.444088333333333c-0.47991666666666666 0 -0.9915666666666666 0.24788833333333332 -1.6360833333333331 0.6207216666666666 -0.2241 0.13088333333333332 -0.4561166666666666 0.27564999999999995 -0.7020333333333333 0.4263666666666666 -0.4620666666666667 0.28556666666666664 -0.9915499999999999 0.6088166666666666 -1.5864833333333332 0.9320666666666666C1.79085 4.629716666666667 0.6624466666666666 6.3133833333333325 0.6624466666666666 8.114049999999999c0 3.012366666666667 3.113503333333333 5.463516666666667 6.9409366666666665 5.463516666666667 3.8274166666666667 0 6.940916666666666 -2.4511499999999997 6.940916666666666 -5.463516666666667 0 -1.8006666666666666 -1.1284 -3.484333333333333 -3.0183 -4.501683333333333 -0.7496333333333333 -0.3966166666666667 -1.33465 -0.76945 -1.8086166666666665 -1.0629499999999998 -0.21616666666666665 -0.13286666666666666 -0.41446666666666665 -0.2558333333333333 -0.5949333333333333 -0.3649 -0.6008833333333333 -0.35696666666666665 -1.0391499999999998 -0.5552716666666666 -1.5190666666666666 -0.5552716666666666Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#b71422'
          d='M9.001366666666666 9.561733333333333c-0.08908333333333332 0.3648833333333333 -0.29186666666666666 0.6919833333333334 -0.5790666666666666 0.93405 -0.21561666666666668 0.209 -0.4947333333333333 0.34019999999999995 -0.79325 0.37281666666666663 -0.30748333333333333 -0.027450000000000002 -0.5963999999999999 -0.15896666666666665 -0.8190333333333333 -0.37281666666666663 -0.28425 -0.24321666666666666 -0.4841833333333333 -0.5701999999999999 -0.5711333333333333 -0.93405 -0.005833333333333334 -0.04378333333333333 0.008916666666666666 -0.0878 0.03995 -0.11921666666666667s0.07485 -0.04671666666666666 0.1187 -0.041416666666666664h2.4471666666666665c0.04353333333333333 -0.004633333333333333 0.08676666666666666 0.010949999999999998 0.11733333333333332 0.042283333333333326 0.030549999999999997 0.03133333333333333 0.04504999999999999 0.07494999999999999 0.03933333333333333 0.11834999999999998Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#ff6164'
          d='M6.810116666666667 10.511683333333332c0.22218333333333332 0.21398333333333333 0.5100499999999999 0.34673333333333334 0.81705 0.3768 0.3062833333333333 -0.0305 0.5933999999999999 -0.16321666666666665 0.8150499999999999 -0.3768 0.07091666666666666 -0.06608333333333333 0.13716666666666666 -0.13698333333333332 0.19831666666666664 -0.2122 -0.24691666666666667 -0.2801166666666667 -0.5985166666666666 -0.44586666666666663 -0.9717333333333333 -0.4581 -0.4010666666666667 0.0095 -0.7718333333333334 0.21565 -0.9915499999999999 0.5513166666666667 0.0456 0.04165 0.08526666666666667 0.0813 0.13286666666666666 0.11898333333333333Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#000000'
          d='M6.841849999999999 10.355049999999999c0.1992 -0.2574833333333333 0.5054 -0.4094833333333333 0.8309333333333333 -0.4124833333333333 0.2969833333333333 0.008749999999999999 0.57995 0.12831666666666666 0.79325 0.33514999999999995 0.0456 -0.049583333333333326 0.08923333333333333 -0.10114999999999999 0.13088333333333332 -0.1527 -0.25229999999999997 -0.24028333333333332 -0.5857 -0.3769 -0.93405 -0.38275 -0.37694999999999995 0.00325 -0.7326833333333332 0.17493333333333333 -0.96975 0.46801666666666664 0.04688333333333333 0.05095 0.09653333333333333 0.09928333333333333 0.14873333333333333 0.14476666666666665Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#000000'
          d='M7.6212333333333335 10.987649999999999c-0.33046666666666663 -0.028949999999999997 -0.64145 -0.16873333333333332 -0.8824833333333333 -0.3966333333333333 -0.30698333333333333 -0.2596333333333333 -0.52305 -0.6104833333333333 -0.6167499999999999 -1.0014666666666665 -0.013616666666666666 -0.0705 0.005333333333333333 -0.1433833333333333 0.05155 -0.19831666666666664 0.05508333333333333 -0.0665 0.1377833333333333 -0.10383333333333333 0.2241 -0.10113333333333333h2.4471666666666665c0.08613333333333334 -0.0018166666666666665 0.16848333333333332 0.03535 0.2241 0.10113333333333333 0.04578333333333333 0.055150000000000005 0.06401666666666667 0.12811666666666666 0.04956666666666666 0.19831666666666664 -0.0937 0.3909833333333333 -0.30976666666666663 0.7418333333333332 -0.6167499999999999 1.0014666666666665 -0.24051666666666666 0.22749999999999998 -0.5507333333333333 0.3672333333333333 -0.8805000000000001 0.3966333333333333Zm-1.2235833333333332 -1.4675166666666666c-0.031733333333333336 0 -0.03966666666666666 0.013883333333333333 -0.04165 0.017849999999999998 0.08383333333333333 0.33904999999999996 0.27344999999999997 0.6426 0.5414 0.8666333333333333 0.19591666666666666 0.19301666666666664 0.45065 0.31515 0.7238333333333333 0.3470333333333333 0.2724833333333333 -0.031516666666666665 0.5269166666666667 -0.15211666666666665 0.7238333333333333 -0.34306666666666663 0.2671 -0.22441666666666665 0.456 -0.5279 0.5394166666666667 -0.8666333333333333 -0.008816666666666667 -0.012933333333333333 -0.024133333333333333 -0.019816666666666666 -0.03966666666666666 -0.017849999999999998l-2.4471666666666665 -0.003966666666666667Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#febbd0'
          d='M10.621633333333332 9.6847c0.6407166666666666 0 1.1601333333333332 -0.30543333333333333 1.1601333333333332 -0.6822s-0.5194166666666666 -0.6821833333333333 -1.1601333333333332 -0.6821833333333333 -1.1601333333333332 0.30541666666666667 -1.1601333333333332 0.6821833333333333c0 0.3767666666666667 0.5194166666666666 0.6822 1.1601333333333332 0.6822Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#febbd0'
          d='M4.618783333333333 9.6847c0.6407166666666666 0 1.1601333333333332 -0.30543333333333333 1.1601333333333332 -0.6822s-0.5194166666666666 -0.6821833333333333 -1.1601333333333332 -0.6821833333333333 -1.1601166666666667 0.30541666666666667 -1.1601166666666667 0.6821833333333333c0 0.3767666666666667 0.5194 0.6822 1.1601166666666667 0.6822Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#000000'
          d='M5.163966666666666 8.728816666666667c0.4421333333333333 0.0007999999999999999 0.8411833333333334 -0.2649333333333333 1.0109333333333332 -0.6731833333333334 0.16974999999999998 -0.40825 0.07675 -0.8785499999999999 -0.23559999999999998 -1.1914833333333332 -0.31235 -0.3129166666666666 -0.7825 -0.4067666666666666 -1.19105 -0.23775000000000002 -0.40856666666666663 0.16899999999999998 -0.6749999999999999 0.5675666666666667 -0.6749999999999999 1.0097 0 0.6027166666666666 0.488 1.0916166666666665 1.0907166666666666 1.0927166666666666Zm4.912183333333333 -0.00001666666666666667c0.44266666666666665 0.0032166666666666667 0.8435333333333334 -0.2609666666666667 1.0151666666666666 -0.6690166666666666 0.17163333333333333 -0.40805 0.08011666666666667 -0.8793333333333333 -0.23176666666666668 -1.1934833333333332 -0.3118666666666666 -0.31415 -0.7824833333333332 -0.4091 -1.1917666666666666 -0.24045s-0.6763999999999999 0.5675833333333333 -0.6763999999999999 1.0102499999999999c-0.0010999999999999998 0.60085 0.4839333333333333 1.0894333333333333 1.0847666666666667 1.0926999999999998Z'
          stroke-width='0.1667'
        ></path>
        <path
          fill='#ffffff'
          d='M4.8269 7.705466666666666c0.16621666666666665 0.0007999999999999999 0.3165 -0.09871666666666667 0.3806666666666666 -0.25203333333333333 0.06416666666666666 -0.15333333333333332 0.02953333333333333 -0.3302333333333333 -0.08771666666666667 -0.44804999999999995 -0.11723333333333333 -0.11781666666666665 -0.29396666666666665 -0.1533 -0.4476 -0.08986666666666666 -0.15363333333333332 0.06341666666666666 -0.2538666666666667 0.21321666666666667 -0.2538666666666667 0.37943333333333334 0 0.22594999999999998 0.18256666666666665 0.40941666666666665 0.40851666666666664 0.41051666666666664Zm4.9121999999999995 0c0.1662 0.0007999999999999999 0.3165 -0.09871666666666667 0.3806666666666666 -0.25203333333333333 0.06416666666666666 -0.15333333333333332 0.02953333333333333 -0.3302333333333333 -0.08771666666666667 -0.44804999999999995 -0.11725 -0.11781666666666665 -0.29396666666666665 -0.1533 -0.4476 -0.08986666666666666 -0.15365 0.06341666666666666 -0.25388333333333335 0.21321666666666667 -0.25388333333333335 0.37943333333333334 -0.00001666666666666667 0.22441666666666665 0.18016666666666664 0.40724999999999995 0.40456666666666663 0.41051666666666664h0.003966666666666667Z'
          stroke-width='0.1667'
        ></path>
      </svg>
    ),
    commandTemplate: 'bun add {package}'
  }
];

const STORAGE_KEY = 'preferred-package-manager';

const PackageManagerTabs: React.FC<PackageManagerTabsProps> = ({
  packageName = 'lovit',
  customPackageManagers,
  ...props
}) => {
  const packageManagers = customPackageManagers || defaultPackageManagers;

  const [activeTab, setActiveTab] = useState(() => {
    if (globalThis.window !== undefined) {
      return globalThis.window.localStorage.getItem(STORAGE_KEY) || packageManagers[0].id;
    }
    return packageManagers[0].id;
  });
  const [copied, setCopied] = useState(false);

  const activePackageManager = packageManagers.find((pm) => pm.id === activeTab);
  const activeCommand = activePackageManager
    ? activePackageManager.commandTemplate.replace('{package}', packageName)
    : '';

  useEffect(() => {
    globalThis.window.localStorage.setItem(STORAGE_KEY, activeTab);
  }, [activeTab]);

  const handleCopy = async () => {
    try {
      await navigator.clipboard.writeText(activeCommand);
      setCopied(true);
      setTimeout(() => setCopied(false), 2000);
    } catch (error) {
      console.error('Failed to copy:', error);
    }
  };

  const renderCommand = (command: string) => {
    const [pkgManager, ...rest] = command.split(' ');
    return (
      <>
        <span className='package-manager'>{pkgManager}</span>
        <span className='command-rest'>{rest.join(' ')}</span>
      </>
    );
  };

  return (
    <div className='package-manager-tabs'>
      <div className='tabs'>
        {packageManagers.map((pm) => (
          <button
            key={pm.id}
            className={`tab ${activeTab === pm.id ? 'active' : ''}`}
            onClick={() => setActiveTab(pm.id)}
          >
            <span className='icon'>{pm.icon}</span> {pm.label}
          </button>
        ))}
      </div>
      <div className='code-block-wrapper'>
        <pre {...props} className='code-block'>
          <code>{renderCommand(activeCommand)}</code>
        </pre>
        <button className='copy-button' onClick={() => void handleCopy()} title='Copy to clipboard'>
          {copied ? (
            <svg
              xmlns='http://www.w3.org/2000/svg'
              width='16'
              height='16'
              viewBox='0 0 24 24'
              fill='none'
              stroke='currentColor'
              strokeWidth='2'
              strokeLinecap='round'
              strokeLinejoin='round'
            >
              <polyline points='20 6 9 17 4 12'></polyline>
            </svg>
          ) : (
            <svg
              xmlns='http://www.w3.org/2000/svg'
              width='16'
              height='16'
              viewBox='0 0 24 24'
              fill='none'
              stroke='currentColor'
              strokeWidth='2'
              strokeLinecap='round'
              strokeLinejoin='round'
            >
              <rect x='9' y='9' width='13' height='13' rx='2' ry='2'></rect>
              <path d='M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1'></path>
            </svg>
          )}
        </button>
      </div>
    </div>
  );
};

export default PackageManagerTabs;
